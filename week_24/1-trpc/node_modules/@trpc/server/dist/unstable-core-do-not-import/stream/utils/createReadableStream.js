'use strict';

var createDeferred = require('./createDeferred.js');

// ---------- utils
/**
 * One-off readable stream
 */ function createReadableStream() {
    let controller = null;
    const deferred = createDeferred.createDeferred();
    let cancelled = false;
    const readable = new ReadableStream({
        start (c) {
            controller = c;
        },
        cancel () {
            deferred.resolve('cancelled');
            cancelled = true;
        }
    });
    return {
        readable,
        controller,
        cancelledPromise: deferred.promise,
        cancelled () {
            return cancelled;
        }
    };
}

exports.createReadableStream = createReadableStream;
